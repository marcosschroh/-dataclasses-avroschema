import datetime
import json
import uuid

from dataclasses_avroschema import SchemaGenerator


def test_logical_types_schema(logical_types_schema):
    """
    Test a schema with Logical Types
    """
    a_datetime = datetime.datetime(2019, 10, 12, 17, 57, 42)

    class LogicalTypes:
        "Some logical types"
        birthday: datetime.date = a_datetime.date()
        meeting_time: datetime.time = a_datetime.time()
        release_datetime: datetime.datetime = a_datetime
        event_uuid: uuid.uuid4 = "09f00184-7721-4266-a955-21048a5cc235"

    schema = SchemaGenerator(LogicalTypes).avro_schema()

    assert schema == json.dumps(logical_types_schema)
